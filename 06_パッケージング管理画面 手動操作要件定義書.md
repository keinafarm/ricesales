### **【成果物 6/11】 `06_パッケージング管理画面 手動操作要件定義書` (Ver. 2.0)**

#### **1. 目的**
本ドキュメントは、「自動引当・パッケージング提案ボード (`SCR-AD-050`)」において、管理者がシステムの自動提案に頼らず、手動で行うことができる全ての操作の仕様を定義する。これにより、自動化と手動介入を組み合わせた柔軟な出荷計画を実現する。

#### **2. UIコンポーネントの定義**
本要件定義書で言及するUIコンポーネントは以下の通り。

*   **未引当在庫パネル:** 画面上部に表示される、まだどの注文にも割り当てられていない「準備済みの袋在庫」の一覧。
*   **宛先カード:** お届け先ごとに生成されるカード。
*   **箱 (パッケージ):** 宛先カード内に配置される、荷物を詰めるための単位。
*   **袋アイテム:** 箱の中に表示される、物理的な袋。
*   **予約アイテム:** 袋在庫は無いが、将来的にこの箱に入れる予定であることを示すプレースホルダー。

#### **3. 手動操作の仕様一覧**

##### **3.1. 箱（パッケージ）に関する操作**

| No. | 操作名 | UI要素 | 操作フロー | システムの挙動 | 前提条件・制約 |
| :-- | :--- | :--- | :--- | :--- | :--- |
| 1 | **箱の新規作成** | 各宛先カードのヘッダーにある `＋ 新しい箱` ボタン | 1. ボタンをクリックする。 | 該当の宛先に、新しい空の箱が追加される。 | なし。 |
| 2 | **箱の削除** | 各箱のフッターにある `削除` ボタン | 1. ボタンをクリックする。 | 対象の箱が画面から削除される。 | ・箱の中に「袋アイテム」がないこと。<br>・箱に「予約アイテム」が設定されていないこと。 |
| 3 | **箱のロック状態変更** | 各箱のヘッダーにある `ロックアイコン` (🔓, 🖇️, 🔒) | 1. アイコンをクリックする。 | アイコンが `変更可` → `追加のみ可` → `変更不可` → `変更可` ... の順にトグルで切り替わる。 | 梱包が「確定」されていないこと。 |
| 4 | **箱の梱包確定** | 各箱のヘッダーにある `確定` ボタン | 1. ボタンをクリックする。 | ・箱のステータスが「発送準備完了」に更新される。<br>・箱が編集不可（ロック）状態になる。<br>・対象の箱が「発送管理画面」の表示対象となる。 | なし。 |
| 5 | **梱包の解除** | ステータスが「発送準備完了」の箱のヘッダーにある `戻す` ボタン | 1. ボタンをクリックする。 | ・箱のステータスが「準備中」に戻る。<br>・箱が再び編集可能な状態になる。 | なし。 |

##### **3.2. 袋（袋アイテム）に関する操作**

| No. | 操作名 | UI要素 | 操作フロー | システムの挙動 | 前提条件・制約 |
| :-- | :--- | :--- | :--- | :--- | :--- |
| 6 | **箱への袋の追加** | 各箱のフッターにある `<i class="bi bi-bag-plus"></i> 袋を追加` ボタン | 1. ボタンをクリックする。<br>2. 「袋を追加」モーダルが表示される。<br>3. 追加したい商品の数量を入力し、「この内容で追加する」ボタンを押す。 | ・システムは、モーダルで指定された商品と数量に基づき、「未引当在庫」または「他の箱の袋」から対象の袋を特定し、この箱に移動させる。<br>・移動と同時に、袋は宛先の注文に自動的に**引当**される。 | ・追加対象の商品について、宛先の注文残（未引当・未予約）があること。<br>・追加対象の商品について、引当可能な袋在庫が存在すること。<br>・箱の重量上限を超えないこと。 |
| 7 | **箱からの袋の削除** | 各袋アイテムの右端にある `×` ボタン | 1. ボタンをクリックする。 | ・対象の袋アイテムが箱から取り除かれる。<br>・袋に紐付いていた**引当が解除**され、袋は「未引当在庫」に戻る。 | 梱包が「確定」されていないこと。 |
| 8 | **箱から別箱への袋の移動** | 各袋アイテムの右端にある `移動アイコン` (▼) から開くドロップダウンメニュー | 1. 移動アイコンをクリックし、移動先の箱を選択する。 | 対象の袋アイテムが、現在の箱から移動先の箱に移動する。 | ・同一宛先内の箱にのみ移動可能。<br>・移動先の箱の重量上限を超えないこと。<br>・梱包が「確定」されていないこと。 |

##### **3.3. 予約（予約アイテム）に関する操作**

| No. | 操作名 | UI要素 | 操作フロー | システムの挙動 | 前提条件・制約 |
| :-- | :--- | :--- | :--- | :--- | :--- |
| 9 | **箱への予約の追加** | 各箱のフッターにある `<i class="bi bi-clock-history"></i> 予約を追加` ボタン | 1. ボタンをクリックする。<br>2. 「予約を追加」モーダルが表示される。<br>3. 予約したい商品の数量を入力し、「この内容で予約する」ボタンを押す。 | 指定された商品と数量の「予約アイテム」が箱に追加される。 | ・予約対象の商品について、宛先の注文残（未引当・未予約）があること。<br>・箱の重量上限を超えないこと。 |
| 10 | **予約の削除（数量減）** | 各予約アイテムの右端にある `×` ボタン | 1. ボタンをクリックする。 | 対象の予約アイテムの数量が1つ減少する。数量が0になった場合は、アイテムがリストから消える。 | 梱包が「確定」されていないこと。 |
| 11 | **予約の充当（在庫引き当て）** | 各予約アイテムの右端にある `📥` ボタン | 1. ボタンをクリックする。 | ・「未引当在庫」から対応する商品の袋が1つ消費される。<br>・対象の予約アイテムが消え、代わりに物理的な「袋アイテム」が箱に追加される。<br>・袋は宛先の注文に自動的に**引当**される。 | ・充当対象の商品について、未引当の準備済み在庫が1つ以上存在すること。<br>・梱包が「確定」されていないこと。 |

---

以上が、パッケージング管理画面における手動操作の仕様です。

ご確認いただき、問題ないようでしたら、いよいよ**「第3部：機能別 実装解説書」**の作成に着手し、最初の解説書として**「【成果物 7/11】 `20_アカウント・顧客管理機能`」**を提示させていただきます。